<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chess Tournament</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css">
    <style>
        /* Global Styles */
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            background-color: #f8f9fa;
            color: #333; /* Added for consistency */
        }
        .container {
            max-width: 960px;
            margin: 0 auto;
            padding: 20px;
        }
        /* Header Styles */
        .navbar-brand {
            font-size: 1.5rem;
        }
        .navbar-text {
            color: #fff;
        }
        /* Sidebar Styles */
        .sidebar {
            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            z-index: 100;
            padding: 20px;
            background-color: #fff;
            border-right: 1px solid #dee2e6;
        }
        .sidebar-heading {
            font-size: 1.2rem;
            margin-bottom: 15px;
            text-align: center;
        }
        .nav-link {
            color: #333;
        }
        /* Main Content Styles */
        .main-content {
            margin-left: 250px;
        }
        h2 {
            margin-top: 20px;
            margin-bottom: 20px; /* Added for spacing */
        }
        /* Form and Button Styles */
        #numPlayersInput {
            margin-bottom: 10px;
        }
        #generateScheduleBtn {
            background-color: #007bff;
            color: #fff;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            transition: background-color 0.3s ease; /* Added for hover effect */
        }
        #generateScheduleBtn:hover {
            background-color: #0056b3;
        }
        /* Schedule Display Styles */
        .round {
            border: 1px solid #ccc;
            padding: 10px;
            margin-bottom: 20px;
        }
        .round-title {
            font-weight: bold;
            margin-bottom: 10px;
        }
        .schedule-item {
            margin-bottom: 10px;
        }

    </style>
</head>
<body>

<header class="navbar navbar-dark sticky-top bg-dark p-0 shadow">
    <div class="container-fluid">
        <a class="navbar-brand me-0" href="#">Murfreesboro Chess Club</a>
        <span class="navbar-text">Active Players: <span id="activePlayerCount">0</span></span>
    </div>
</header>

<div class="container-fluid">
    <div class="row">
        <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
            <div class="position-sticky pt-3">
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link" aria-current="page" href="/">
                            <span data-feather="home"></span>
                            Home
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="/tournament">
                            <span data-feather="play"></span>
                            Tournament
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/inputPlayers">
                            <span data-feather="users"></span>
                            Input Players
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/prizeMoney">
                            <span data-feather="shopping-cart"></span>
                            Prize Money
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/searchPlayer">
                          <span data-feather="search"></span>
                          Search Player
                        </a>
                      </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/scoreReport">
                            <span data-feather="bar-chart-2"></span>
                            Score Report
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">
                            <span data-feather="file"></span>
                            DBF Generator
                        </a>
                    </li>
                </ul>
            </div>
        </nav>
        
        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4 main-content">
            <h1 class="h2">Tournament Schedule</h1>
            <label for="numPlayersInput">Number of Players:</label>
            <input type="number" id="numPlayersInput" min="2" required>
            <button id="generateScheduleBtn">Generate Schedule</button>

            <!-- Tournament schedule -->
            <div id="tournamentSchedule" class="row">
                <!-- Generated schedule will be inserted here --> 
            </div>

            <!-- Second Tournament schedule (Round Robin) -->
            <div id="roundRobinSchedule" class="row d-none">
                <!-- Generated round robin schedule will be inserted here -->
            </div>
        </main>
    </div>
</div>

<script>
function generateRoundRobinSchedule(numPlayers) {
    let schedule = [];
    let totalRounds = numPlayers - 1;

    if (numPlayers % 2 === 1) {
        let byePlayer = numPlayers;
        for (let round = 1; round <= totalRounds; round++) {
            schedule[round - 1].push({
                round,
                board: numPlayers / 2 + 1,
                pairing: `Player ${byePlayer} has a bye`
            });
            // Assigning bye to a different player for each round
            byePlayer = (byePlayer % (numPlayers - 1)) + 1;
        }
    }

    for (let round = 1; round <= totalRounds; round++) {
        let roundMatches = [];
        for (let match = 0; match < numPlayers / 2; match++) {
            let player1 = (round + match) % (numPlayers - 1);
            let player2 = (numPlayers - 1 - match + round) % (numPlayers - 1);
            player1 += 1;
            player2 += 1;
            if (match === 0) {
                player2 = numPlayers;
            }

            // Determine which player is White or Black
            let white = player1 < player2 ? player1 : player2;
            let black = player1 < player2 ? player2 : player1;

            // For an even round, swap colors
            if (round % 2 === 0) {
                [white, black] = [black, white];
            }

            let board = match + 1;
            let pairing = `Player ${white} (W) vs Player ${black} (B)`;
            roundMatches.push({round, board, pairing});
        }
        schedule.push(roundMatches);
    }

    // If there's an odd number of players, add a "bye" for one player in each round
    if (numPlayers % 2 === 1) {
        let byePlayer = numPlayers;
        for (let round = 1; round <= totalRounds; round++) {
            schedule[round - 1].push({ round, board: numPlayers / 2 + 1, pairing: `Player ${byePlayer} has a bye` });
        }
    }

    return schedule;
}

function displaySchedule(schedule) {
    let scheduleHtml = '';
    schedule.forEach((roundMatches, roundIndex) => {
        scheduleHtml += `<div class="round">
            <div class="round-title">Round ${roundIndex + 1}</div>`;
        roundMatches.forEach(match => {
            scheduleHtml += `<div class="schedule-item">Board ${match.board}: ${match.pairing}</div>`;
        });
        scheduleHtml += `</div>`;
    });
    document.getElementById('tournamentSchedule').innerHTML = scheduleHtml;
}

document.getElementById('generateScheduleBtn').addEventListener('click', function() {
    let numPlayers = parseInt(document.getElementById('numPlayersInput').value, 10);
    if (!isNaN(numPlayers) && numPlayers > 1) {
        let schedule = generateRoundRobinSchedule(numPlayers);
        displaySchedule(schedule);
    } else {
        alert("Please enter a valid number of players (greater than 1).");
    }
});
</script>

<!-- Feather Icons and Chart.js scripts -->

<script src="https://cdn.jsdelivr.net/npm/feather-icons@4.28.0/dist/feather.min.js"
        integrity="sha384-uO3SXW5IuS1ZpFPKugNNWqTZRRglnUJK6UAZ/gxOX80nxEkN9NcGZTftn6RzhGWE"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"
        integrity="sha384-zNy6FEbO50N+Cg5wap8IKA4M/ZnLJgzc6w2NqACZaK0u0FXfOWRRJOnQtpZun8ha"
        crossorigin="anonymous"></script>
</body>
</html>
